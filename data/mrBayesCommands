#NEXUS
begin mrbayes;

execute final.taxa.morpho.alignment.nex;


log start replace;

[ Define partitions in data set]

CHARSET skull = 1 - 22 134-139 158 187-206 274 278-281 317-319 350-355 394-400 498-499 517-520 523-535 550 551 570 572 578-611 683 692-702 742-751 756-757 763-767;

CHARSET wings = 42 - 57 76-87 90 91 130 146-151 162-166 223-235 292-299 325-338 359-376 408-418 421-422 425-432 444-445 447-450 466-470 477-478 482-487 490 496-497 510 515-516 522 536-538 542-547 549 556-560 676-682 688-691 703-705 707-711 734-738 758 771-772 775-778;

CHARSET body = 23 - 41 58 59 75 103-104 133 140-145 159-161 167-169 207-222 236-238 275 276 282-291 300-302 320-324 339 356-358 443 492-495 500-502 540-541 552-555 612-620 687 725-728 768-770 774 779-781;

CHARSET legs = 60-74 88-89 92-102 105-129 152-157 170-185 239-269 303-312 340-349 377-392 401-407 419-420 423-424 433-442 446 451-465 471-476 479-481 488-489 491 503-509 514 521 539 548 561-569 571 573-577 621-675 684-686 706 712-724 729-733 739-741 752-755 759-762 773 782;

CHARSET otherMorpho = 132 186 273 276 277 312 130 131 185 269 270 271 272 313 314 392 315 316 510 511 512 393 513;

partition segment = 5: skull, wings, body, legs, otherMorpho ;

set partition = segment;

[ ################################################# ]

[ Specify models of evolution across partitions ]

lset applyto=(all) rates = gamma Coding=variable;
prset applyto=(all) ratepr=variable;

[ ################################################# ]

[ Some characters in the morphological partition are ordered - defined here ]
[ Number corresponds to character number, plus number of nucleotides included ]
ctype ordered: 13  15  26 196 207 210 211 214 247 261 280 297 312 322 325 327 328 332 578 579 580 581 586 587 588 590 592 596 599 601 602 605 607 608 609 610 611 613 614 616 618 622 625 626;

[ ################################################# ]

outgroup Caprimulgus_vociferus  ;

[ ################################################# ]

[Topological constraints]

constraint root = 1-. ;

[ ################################################# ]

[Calibrate fossil species]

calibrate Miocoracias_chenevali = uniform(20,22)
	  Brachypteracias_langrandi = uniform(0.001, 0.002)
	  Eocoracias_brachyptera = uniform(40.4, 48.6)
	  Geranopterus_alatus = uniform(33.9, 37.2)
	  Geranopterus_milneedwardsi = uniform(33.9, 37.2)
	  Geranopterus_bohemicus = uniform(15, 17.5)
	  Species_A = uniform(35,50)
	  Species_B = uniform(35,50)
	  Primobucco_mcgrewi = uniform(48.6, 55.8)
	  Primobucco_frugilegus = uniform(40.4, 48.6)
	  Primobucco_perneri = uniform(40.4, 48.6)
	  Paracoracias_occidentalis = uniform(45,55)
	  Paleotodus_itardiensis = uniform(28.4, 33.9)
	  Paleotodus_emryi = uniform(33.3,33.9)
	  Paleotodus_escampsiensis = uniform(34,36)
	  Motmot_indet = uniform(4.9,10.3)
	  Protornis_glarniensis = uniform(28.4,33.9)
	  Alcedinidae_indet = uniform(15,25)
	  Quasisyndactylus_longibrachis = uniform(45,55)
	  Plesiocathartes_wyomingensis = uniform(33,45)
	  Plesiocathartes_major = uniform(33,45)
	  Plesiocathartes_kelleri = uniform(48,51)
	  Plesiocathartes_geiselensis = uniform(33,45)
	  Plesiocathartes_europaeus = uniform(33,45)
	  Plesiocathartes_spp = uniform(51,54.5)
	  Primotrogon_spp = uniform(51,54.5)
	  Primotrogon_spp1 = uniform(30,34)
	  Primotrogon_wintersteini = uniform(28.4,33.9)
	  Primotrogon_pumilio = uniform(40.4,49)
	  Septenotrogon_madseni = uniform(48.6,55.8)
	  Upupa_antaios = uniform(0.0001,0.001)
	  Phirriculus_pinicola = uniform(17,22)
	  Messelirrisor_grandis = uniform(40.4,48.6)
	  Messelirrisor_halcyrostris = uniform(40.4,48.6)
	  Messelirrisor_parvus = uniform(40.4,48.6)
	  Hoopoe_spp = uniform(30.5,31.5)
	  Selmes_absurdipes = uniform(42,48)
	  Masillacolius_brevidactylus = uniform(46,52)
	  Oligocolius_psittacocephalon = uniform(24.6,24.8)
	  Oligocolius_brevitarsus = uniform(28.4,33.9)
	  Primocolius_minor = uniform(37.2,40.4)
	  Primocolius_sigei = uniform(37.2,40.4)
	  Clericolius_acriala = uniform(51.57,51.75)
	  Palaeospiza_bella = uniform(33.9,37.2)
	  Eocolius_walkeri = uniform(54.4,56.4)
	  Necrornis_palustris = uniform(11.1, 13.7)
	  Uintornis_lucaris = uniform(37.2, 48.6)
	  Uintornis_marionae = uniform(37.2,48.6)
	  Eobucco_brodkorbi = uniform(39,50)
	  Chascacocolius_cacicirostris = uniform(40.4, 55.8)
	  Chascacocolius_oscitans = uniform(50,54)
	  Sandcoleidae_indet = uniform(45,52)
	  Coliiformes_indet = uniform(45,52)
	  Botauroides_parvus = uniform(37.2,48.6)
	  Eoglaucidium_pallas = uniform(48.5, 55.8)
	  Eoglaucidium_spp = uniform(48.5, 55.8)
	  Anneavis_anneae = uniform(50.3, 55.4)
	  Selmes_MNH.Q.O.596 = uniform(23.03,40.4)
	  Sandcoleus_copiosus = uniform(50.3,55.8)
	  Sylphornis_bretouensis = uniform(33.9,38)
	  Neanis_kistneri = uniform(50.3,55.8)
	  Capitonides_europeus = uniform(16.9,20)
	  Capitonides_protractus = uniform(13.8,16)
	  Cyrilavis_olsoni = uniform(48.6,55.8)
	  Pseudasturides_macrocephalus = uniform(48,52)
	  Serudaptus_pohli = uniform(40.4,48.6)
	  Pulchrapollia_gracilis = uniform(48.6,55.8)
	  Vastanavis_eocaena = uniform(48.6, 55.8)
	  Vastanavis_cambayensis = uniform(48.6,55.8)
	  Quercypsitta_sudrei = uniform(33.9,37.2)
	  Quercypsitta_ivani = uniform(33.9, 37.2)
	  Messelastur_gratulator = uniform(40.4, 48.6)
	  Avolatavis_tenens = uniform(51.57,51.75)
	  Psittacopes_lepidus = uniform(48,52)
	  London_Clay_Species_A = uniform(48.6,55.8)
	  Nelepsittacus_minimus = uniform(16,19)
	  Nelepsittacus_donmertoni = uniform(16,19)
	  Nelepsittacus_daphneleeae = uniform(16,19)
	  Mopsitta_tanta = uniform(48.6, 55.8)
	  Psuedasturidae_indet = uniform(48.6, 55.8)
	  Bavaripsitta_ballmanni = uniform(13.5, 15)
	  Xenopsitta_feifari = uniform(16,23)
	  Palaeopsittacus_georgei = uniform(48.6,55.8)
	  Mogontiacopsitta_miocaena = uniform(22,24)
	  Cacatua_spp = uniform(16,23)
	  Primozygodactylus_danielsi = uniform(48,51)
	  Primozygodactylus_eunjooae = uniform(40.4, 48.6)
	  Primozygodactylus_major = uniform(40.4, 48.6)
	  Primozygodactylus_ballmani = uniform(48,51)
	  Eozygodactylus_americanus = uniform(50.3,55.8)
	  Primoscens_minutus = uniform(48,55)
	  Zygodactylus_grandis = uniform(50.3,55.8)
	  Zygodactylus_ignotus = uniform(16.9,20)
	  Zygodactylidae_UWGM21421 = uniform(50.3, 55.8)
	  Zygodactylidae_FMNHPA757 = uniform(50.3, 55.8)
	  Zygodactylidae_UWGM40363 = uniform(50.3,55.8)
	  Zygodactylus_grivensis = uniform(40.4, 48.6)
	  Zygodactylus_luberonensis = uniform(28.4 ,33.9)
	  Rupelramphastoides_knopfi = uniform(28.4,33.9)
	  Picavus_litenicensis = uniform(29.5, 32)
	  Palaeonerpes_shorti = uniform(2.5,6)
	  Campephilus_dalquesti = uniform(0.3, 1.8)
	  Pici_indet = uniform(23,28.4)
	  Colaptes_spp = uniform(1.8,4.9)
	  Australopicus_nelsonmandelai = uniform(3.6,5.3)
	  Piculoides_saulcetensis = uniform(20.4,23)
	  Eclectus_infectus = uniform(0.01,1)
	  Pseudoseisuropsis_cuelloi = uniform(0.001,2.6)
	  Pseudoseisuropsis_nehuen = uniform(0.001,1)
	  Traversia_lyalli = uniform(0.0001,1)
	  Dendroscansor_decurvirostris = uniform(0.1,1)
	  Pachyplichas_yaldwyni = uniform(0.01,1)
	  Pachyplichas_jagmi = uniform(0.01,1)
	  Kuiornis_indicator = uniform(15.9,19)
	  Pica_mourerae = uniform(0.781,3.6)
	  Pandanaris_convexa = uniform(0.001,0.3)
	  Orthonyx_kaldowinyeri = uniform(11.6,16)
	  Kurraratapu_johnnguyeni = uniform(16,23)
	  Rhodospiza_shaamarica = uniform(2.6,3.2)
	  Pliocalcarius_orkhonensis = uniform(2.6,3.2)
	  Certhiops_rummeli = uniform(18,20.5)
	  Passerine_indet = uniform(28,34)
;

[ ################################################# ]

[ Specify priors for tree ]

PRSET brlenspr = clock:uniform;
PRSET clockvarpr=igr;
PRSET igrvarpr=exp(10) ; [default]
PRSET clockratepr=lognorm(-7.386,1); [Ericson et al 2014 BMC Biology]

[ ################################################# ]

[Node calibrations]

calibrate root = uniform(50,150);

[ ################################################# ]

[Previously defined topological constraints NOT enforced]

PRSET nodeagepr = calibrated;


[ ################################################# ]

unlink revmat=(all) shape=(all) pinvar=(all) statefreq=(all) tratio=(all);


[ ################################################# ]

[ Specify paramaters for MCMC run]

mcmcp samplefreq=1000 printfr=500 nruns=2 nchain=8 relburnin=yes burninfrac=0.5 savebrlens = yes temp=0.01 checkfreq=10000 Diagnfreq=2000 Nswaps=2 Swapfreq=50;

mcmc ngen=150000000 append=yes;

sump ;
sumt ;

log stop;


end;
